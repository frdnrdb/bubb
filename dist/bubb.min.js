!function(){"use strict";var a=this,b=function(a,d){b.config=b.config||("object"==typeof a?a:{}),b.config._=b.config._||a._||{},b.callback=b.callback||"function"==typeof d&&d;var e=Array.from(document.querySelectorAll("[data-bubb]:not(.bubb)"));e.length&&e.forEach(c)};b.update=function(a,b){return f(a,b)},b.add=b.refresh=function(){return g.apply(a,arguments)},b.remove=function(){return g.apply(a,arguments)};var c=function(c){function e(){return i.reduce(function(a,c){return(g=l&&l[c]||b.config._[c])&&(a[c]=g),a},{})}function f(a,c,d){if("_"!==d){var e=d?b.config[a][d]:b.config[a]||a,f=a+(d&&"text"!==d?"."+d:""),g=' data-bubb-value="'+f+'"';return c+="<div "+g+(">"+e)+"</div>"}}var g,h=c.dataset.bubb.trim(),j=b.config[h],k="object"==typeof j,l=k&&j._,m=k&&!j.hasOwnProperty("text"),n="function"==typeof b.callback||"function"==typeof b.config._.callback;c.bubb={config:e(),type:m?"menu":l?"opts":"string",bind:m&&n||l&&"function"==typeof l.callback};var o=m?Object.keys(j):l?["text"]:[!1],p=o.reduce(f.bind(a,h),"");d(c,null,p)},d=function(a,b,c){b=b||document.createElement("aside");var d=a.bubb.config,f=!c;d.background&&(b.style.background=d.background,b.style.borderBottomColor=d.background),d.color&&(b.style.color=d.color),a.classList.add("bubb"),d.transitionOff?a.classList.add("bubb-still"):f&&a.classList.remove("bubb-still"),d.delay?a.classList.add("bubb-delayed"):f&&a.classList.remove("bubb-delayed"),("menu"===a.bubb.type||d.callback)&&a.classList.add("bubb-interactive"),d.interactive?a.classList.add("bubb-interactive"):f&&d.hasOwnProperty("interactive")&&a.classList.remove("bubb-interactive"),"menu"===a.bubb.type&&a.classList.add("bubb-menu"),f||(b.innerHTML=c,a.appendChild(b)),a.bubb.bind&&e(a)},e=function(a){function c(c){var d=a.bubb.config.hoverCallback,e=d?this.dataset.bubb:c.target.dataset.bubbValue||c.target.parentNode.dataset.bubbValue;if(e){var f="function"==typeof this.bubb.config.callback&&this.bubb.config.callback||b.callback,g=this.querySelector('[data-bubb-value="'+this.dataset.bubb+'"]')||c.target;f(e,g)}}a.bubb.bind=!0,a.addEventListener(j?"touchstart":a.bubb.config.hoverCallback?"mouseenter":"click",c,!1)},f=function(a,b){if("string"==typeof a&&b){var c,f="object"==typeof b,g=document.querySelector('[data-bubb-value="'+a+'"]');if(!g&&f&&(c=document.querySelector('[data-bubb="'+a+'"]')),g||c){f||(g.innerHTML=b);var j=c||g.parentNode.parentNode;if(f){var k="boolean"==typeof b.callback&&!j.bubb.bind,l=b.callback&&!j.bubb.config.hasOwnProperty("callback"),m=b.hoverCallback&&!j.bubb.config.hoverCallback;Object.keys(b).forEach(function(a){~i.indexOf(a)&&(j.bubb.config[a]=b[a])});var n=c?c.children[0]:g.parentNode;d(j,n),(k||l||m)&&e(j)}h(a,b,f,j)}}},g=function(){if(0===arguments.length)return void b();var a=arguments[0],c=arguments[1],d=a.split(".").reduce(function(a,b,c){return a[["key","val"][c]]=b,a},{});if(d.val&&b.config[d.key]){if(c&&"string"==typeof c&&!b.config[d.key][d.val])return b.config[d.key][d.val]=c,void document.querySelector('[data-bubb="'+d.key+'"]').children[0].insertAdjacentHTML("beforeend",'<div data-bubb-value="'+a+('">'+c)+"</div>");if(!c&&b.config[d.key][d.val]){delete b.config[d.key][d.val];var e=document.querySelector('[data-bubb="'+d.key+'"]').children[0];Array.from(e.children).forEach(function(b){b.dataset.bubbValue===a&&e.removeChild(b)})}}},h=function(a,c,d,e){var f="menu"===e.bubb.type,g="opts"===e.bubb.type,h=~a.indexOf(".")&&a.split("."),i=h?h.reduce(function(a,b,c){return a[["key","val"][c]]=b,a},{}):{};if(!f&&!g&&!d)return void(b.config[a]=c);var j=i.key||a;return d?f||g?(b.config[j]._=b.config[j]._||c,void Object.assign(b.config[j]._,c)):(b.config[j]={text:b.config[j],_:c},void("opts"===e.bubb.type)):void(b.config[j][i.val||"text"]=c)},i=["callback","hoverCallback","background","color","transitionOff","interactive","delay"],j=!("undefined"==typeof window.orientation&&!~navigator.userAgent.indexOf("IEMobile"));"undefined"!=typeof module&&module.exports?module.exports=b:window.bubb=b}();